#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

# ==========================
# ğŸ¯ Husky Hook - pre-commit
# ==========================

# Ativa o modo de log detalhado (exibe comandos executados)
set -e

echo ""
echo "ğŸ¦Š [Husky] Iniciando pre-commit hook..."
echo "-----------------------------------------"

# Verifica se hÃ¡ arquivos no stage
if git diff --cached --quiet; then
  echo "âš ï¸  Nenhum arquivo adicionado para commit. Pulando lint-staged."
  exit 0
fi

# Mostra arquivos que serÃ£o verificados
echo "ğŸ“‚ Arquivos no stage:"
git diff --cached --name-only
echo ""

# Executa lint-staged
echo "ğŸš€ Executando lint-staged..."
npx lint-staged

# Captura o cÃ³digo de saÃ­da
STATUS=$?

if [ $STATUS -eq 0 ]; then
  echo "âœ… lint-staged finalizado com sucesso!"
else
  echo "âŒ Erro ao rodar lint-staged. Abortando commit."
  exit 1
fi

echo "-----------------------------------------"
echo "ğŸ¦Š [Husky] Pre-commit concluÃ­do!"
echo ""
